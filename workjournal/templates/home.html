<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="/static/css/fonts.css" media="all">
    <link rel="stylesheet" href="/static/css/home.css" media="all">
</head>
<body>
    <header class="container">
        <h1>WORK JOURNAL</h1>
    </header>

    <div class="main container">
        <form action="">

        <section class="git">
            <div class="section-title">Git Commits
                {% if commits.commits %}
                <div class="counter"><span class="number">{{ commits.commits|length }}</span> selected</div>
                {% endif %}
            </div>
            
            {% if commits.commits %}
                <div class="commits">
                    <ul>
                    {% for commit, branches in commits.commits %}
                        <li>
                            <span class="mark marked"></span>
                            <span class="number">{{ loop.index }}</span>
                            <span class="message">{{ commit.message }}</span>
                            <span class="branches">{{ ','.join(branches) }}</span>
                            <span class="time">{{ commit.authored_date|timestamp2strftime }}</span>
                        </li>
                    {% endfor %}
                    </ul>
                    <input type="hidden" name="branches">
                </div>
            {% else %}
                <div class="nocommits">No Commits Today</div>
            {% endif %}
        </section>

        <section class="editor">
            <div class="section-title">My Journal</div>
                <div id="epiceditor"></div>
        </section>

        <section class="buttons">
            <input type="submit" value="Preview">
        </section>

        </form>
    </div>

    <footer class="container">
        Project source: <a href="https://github.com/reorx/workjournal">workjournal</a>. Made by @<a href="http://github.com/reorx">reorx</a>
    </footer>

    <script src="/static/js/jquery-2.0.3.min.js" type="text/javascript"></script>
    <script src="/static/EpicEditor/js/epiceditor.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var opts = {
            container: 'epiceditor',
            textarea: null,
            basePath: '/static/EpicEditor',
            clientSideStorage: true,
            localStorageName: 'epiceditor',
            useNativeFullscreen: true,
            parser: marked,
            file: {
                name: 'epiceditor',
                defaultContent: '',
                autoSave: 100
            },
            theme: {
                base: '/themes/base/epiceditor.css',
                preview: '/themes/preview/github.css',
                editor: '/themes/editor/epic-light.css'
            },
            button: {
                preview: true,
                fullscreen: false,
                bar: "auto"
            },
            focusOnLoad: true,
            shortcut: {
                modifier: 18,
                fullscreen: 70,
                preview: 80
            },
            string: {
                togglePreview: 'Toggle Preview Mode',
                toggleEdit: 'Toggle Edit Mode',
                toggleFullscreen: 'Enter Fullscreen'
            },
            autogrow: {
                maxHeight: 500,
                minHeight: 300
            }
        }
        var editor = new EpicEditor(opts).load();

        $('.git .commits ul li').on('click', function() {
            var $this = $(this);
            $this.find('.mark').toggleClass('marked');
            var marked = $('.git .commits ul li .mark.marked')
            $('.section-title .counter .number').html(marked.length);
        })
    </script>

</body>
</html>
